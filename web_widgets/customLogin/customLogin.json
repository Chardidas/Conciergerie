{"designerVersion":"1.2.9","favorite":false,"id":"customLogin","name":"login","lastUpdate":1512479766329,"template":"<style>\n    .login{\n        display:inline-block;\n    }\n    .login span{\n        display:inline-block;\n        margin:10px;\n    }\n    .login img{\n        display:inline-block; \n        max-width: 40px;\n        margin-top: 4px; \n        float: {{ properties.avatarAlignment }};\n    }\n</style>\n\n<div class=\"text-{{ properties.alignment }}\">\n    <div class=\"login\">\n        <span style=\"\">{{ firstName }} {{ lastName }}</span>\n        <img ng-if=\"icon && properties.showAvatar\" ng-src=\"{{ icon }}\" class=\"img-responsive\"/>\n    </div>\n    <a ng-click=\"logout()\" ng-class=\"'btn btn-' + properties.buttonStyle\">{{ properties.value | uiTranslate }}</a>\n</div>\n\n\n","controller":"function WidgetsimpleButtonController($scope, $http, $location) {\n    'use strict';\n    var ctrl = this;\n    var mainPath = window.top.location.pathname.split( '/' );\n    var newPathname = \"\";\n    \n    for (var i = 1; i < mainPath.length - 2; i++) {\n      newPathname += \"/\";\n      newPathname += mainPath[i];\n    }\n  \n    function getSession() {\n       return  $http.get('/bonita/API/system/session/unusedid');\n    }\n    \n    function getUser(id) {\n        $http.get('/bonita/API/identity/user/'+id).success(function(data){\n            $scope.firstName = data.firstname;\n            $scope.lastName = data.lastname;\n            $scope.icon = \"/bonita/portal/attachmentImage?src=\"+data.icon;\n        });\n    }\n    \n    getSession().then(function(response) {\n        var session = response.data;\n        getUser(session.user_id);\n    });\n\n    $scope.logout = function(){\n        \n        $http.get('/bonita/logoutservice').\n            success(function(data, status, headers, config) {\n                if($scope.properties.redirectUrl){\n                    window.top.location.href = \"/bonita/login.jsp?redirectUrl=\" + $scope.properties.redirectUrl;\n                    \n                    //Go back to actual page\n                    //window.top.location.href = window.location.href;\n                }else{\n                    window.top.location.href = \"/bonita/login.jsp?redirectUrl=\" + newPathname;\n                }\n        });\n    };\n}","custom":true,"properties":[{"label":"Value","name":"value","type":"text","defaultValue":"Logout","bond":"expression"},{"label":"Alignment","name":"alignment","type":"choice","defaultValue":"right","choiceValues":["left","center","right"],"bond":"expression"},{"label":"Button Style","name":"buttonStyle","type":"choice","defaultValue":"danger","choiceValues":["default","primary","success","info","warning","danger","link"],"bond":"expression"},{"label":"Avatar Alignment","name":"avatarAlignment","type":"choice","defaultValue":"right","choiceValues":["left","right"],"bond":"expression"},{"label":"Show avatar","name":"showAvatar","type":"boolean","defaultValue":true,"choiceValues":["yes","no"],"bond":"expression"},{"label":"Redirect URL after Logout","name":"redirectUrl","type":"text","bond":"expression"}],"assets":[{"id":"0749f40d-6e45-451c-b8ea-019d4a1170f7","name":"https://code.jquery.com/jquery-2.1.4.min.js","type":"js","order":1,"external":true}],"type":"widget"}