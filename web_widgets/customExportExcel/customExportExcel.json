{"designerVersion":"1.3.25","favorite":false,"id":"customExportExcel","name":"exportExcel","lastUpdate":1518992610919,"template":"<div class=\"text-{{ properties.alignment }}\">\n    <button\n        ng-class=\"'btn btn-' + properties.buttonStyle\"\n        ng-click=\"ctrl.action()\"\n        type=\"button\"\n        ng-disabled=\"properties.disabled || ctrl.busy\" ng-bind-html=\"properties.label | uiTranslate\"></button>\n</div>\n","icon":"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 20'><g><path fill='#CBD5E1' d='M47,15.2c0,0.7-1.7,1.8-1.7,1.8S4.8,17,3.7,17c-1.6,0-3.6-1.9-3.6-1.9s0.7,4.8,4,5c2.4,0.1,42.4,0,42.4,0 s3.5-0.2,3.5-3.6c0-1.3,0.1-11.5,0.1-12.4c-0.1-2-4-4-4-4L47,1.8C47,1.8,47,14.5,47,15.2z'/><path fill='#fff' d='M3.9,1h40.3C45.7,1,47,2.2,47,3.6v10.8c0,1.4-1.3,2.6-2.9,2.6H3.9C2.3,17,1,15.8,1,14.4V3.6 C1,2.2,2.3,1,3.9,1z M3,0C1.3,0,0,1.3,0,3v12c0,1.7,1.3,3,3,3h42c1.7,0,3-1.3,3-3V3c0-1.7-1.3-3-3-3H3z'/></g></svg>","controller":"function PbButtonCtrl($scope, $log) {\n\n  'use strict';\n\n  var vm = this;\n\n  this.action = function action() {\n\n    //var header = {\"statutDemande\": \"Statut de la demande\",\"caseId\":\"Numéro de la demande\", \"famille\" : \"Famille\", \"sousFamille\":\"Sous Famille\",\"dateDemande\": \"Date de la demande\",\"libelleDemande\": \"Libéllé de la demande\"};\n\t//$scope.exportedData = angular.copy($scope.taskDetails);\n\t//$scope.exportedData = $filter('filter')($scope.exportedData, $scope.customFilter);\n\t\n\t$scope.properties.exportedData.unshift($scope.properties.header);\n\t//$scope.properties.exportedData.unshift(header);\n\talasql('SELECT * INTO XLSX(\"' + $scope.properties.filename +'\",{headers:false}) FROM ?',[$scope.properties.exportedData]);\n  };\n}\n","description":"Trigger for an action in a page or form","custom":true,"order":10,"properties":[{"label":"Disabled","name":"disabled","type":"boolean","defaultValue":false,"bond":"expression"},{"label":"Label","name":"label","type":"text","defaultValue":"Submit","bond":"interpolation"},{"label":"Alignment","name":"alignment","type":"choice","defaultValue":"left","choiceValues":["left","center","right"],"bond":"constant"},{"label":"Style","name":"buttonStyle","type":"choice","defaultValue":"default","choiceValues":["default","primary","success","info","warning","danger","link"],"bond":"constant"},{"label":"Exported file name (with extension)","name":"filename","type":"text","defaultValue":"export.xslx","bond":"expression"},{"label":"Exported data","name":"exportedData","help":"Data that should be exported as excel file.","type":"text","bond":"expression"},{"label":"Excel Data Header","name":"header","type":"text","bond":"expression"}],"assets":[{"id":"5240d0f8-f466-4969-b636-b127b23e10ce","name":"alasql.min.js","type":"js","order":1,"external":false},{"id":"4e1238dc-7951-4689-a90c-bc3831338c89","name":"xlsx.core.min.js","type":"js","order":2,"external":false}],"type":"widget"}