{"designerVersion":"1.3.25","favorite":false,"id":"94ed89be-ab60-436e-bff5-9858c2bc5e78","name":"detailsOffreReservation","type":"page","lastUpdate":1519691117884,"rows":[[{"type":"container","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":true},"repeatedCollection":{"type":"variable"}},"reference":"88c53317-dc78-4f35-ab21-471a02d2daa3","rows":[[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"text":{"type":"interpolation","value":"{{offre}}"},"alignment":{"type":"constant","value":"left"}},"reference":"e4431fe3-344c-4766-bec0-80bab4c4d687","id":"pbText"}]]}],[{"type":"component","dimension":{"md":12,"sm":12,"xs":12,"lg":12},"propertyValues":{"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"level":{"type":"constant","value":"Level 1"},"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant","value":"pbTitle"},"isDisplayed":{"type":"constant","value":true},"label":{"type":"constant"},"text":{"type":"interpolation","value":"Details de l'offre - {{offre.type}}{{(offre.id ? ' - ' + offre.id : '' )}}"},"alignment":{"type":"constant","value":"left"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.TitleWidget"},"dimension":{"type":"constant","value":12},"hidden":{"type":"constant","value":false}},"reference":"497a6581-a72d-4c76-979b-4879746ee738","id":"pbTitle"}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"text":{"type":"interpolation","value":"Description"},"level":{"type":"constant","value":"Level 2"},"alignment":{"type":"constant","value":"left"}},"reference":"75ef7ceb-2ecd-4789-b1fb-710933d2bee9","id":"pbTitle"}],[{"type":"container","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"repeatedCollection":{"type":"variable"}},"reference":"bd9c0d2e-108f-442b-a0e2-4f2e56df1dbb","rows":[[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":true},"text":{"type":"interpolation","value":"{{visuelURL}}"},"alignment":{"type":"constant","value":"left"}},"reference":"2a924e41-7a4c-46d2-929c-c92c58dc8ecd","id":"pbText"}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"srcType":{"type":"constant","value":"URL"},"url":{"type":"expression","value":"visuelURL"},"assetName":{"type":"constant"},"alt":{"type":"interpolation","value":"Pas de visuel."}},"reference":"b37aaa1a-bba8-4610-aca7-16cbc4e20b53","id":"pbImage"}]]}],[{"type":"container","dimension":{"md":12,"sm":12,"xs":12,"lg":12},"propertyValues":{"repeatedCollection":{"type":"variable"},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant"},"isDisplayed":{"type":"constant","value":true},"label":{"type":"constant"},"alignment":{"type":"constant","value":"left"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.WidgetContainer"},"dimension":{"type":"constant","value":12},"hidden":{"type":"constant","value":false}},"reference":"f442f2ee-6e9a-4dac-9a95-f808ebf41ddc","rows":[[{"type":"component","dimension":{"md":6,"sm":12,"xs":12,"lg":6},"propertyValues":{"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant","value":"pbInput"},"isDisplayed":{"type":"constant","value":true},"labelWidth":{"type":"constant","value":1},"label":{"type":"constant","value":"Type"},"type":{"type":"constant","value":"text"},"required":{"type":"constant","value":false},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"labelPosition":{"type":"constant","value":"top"},"placeholder":{"type":"constant"},"alignment":{"type":"constant","value":"left"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.InputWidget"},"dimension":{"type":"constant","value":12},"value":{"type":"variable","value":"offre.type"},"hidden":{"type":"constant","value":false},"minLength":{"type":"constant","value":""},"maxLength":{"type":"constant","value":""},"readOnly":{"type":"constant","value":true},"min":{"type":"constant"},"max":{"type":"constant"},"step":{"type":"constant","value":1}},"reference":"f12dd374-8cce-41c0-bd96-66009ef0d31d","id":"pbInput"},{"type":"component","dimension":{"md":6,"sm":12,"xs":12,"lg":6},"propertyValues":{"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant","value":"pbInput"},"isDisplayed":{"type":"constant","value":true},"labelWidth":{"type":"constant","value":1},"label":{"type":"constant","value":"Id"},"type":{"type":"constant","value":"text"},"required":{"type":"constant","value":false},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"labelPosition":{"type":"constant","value":"top"},"placeholder":{"type":"constant"},"alignment":{"type":"constant","value":"left"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.InputWidget"},"dimension":{"type":"constant","value":12},"value":{"type":"variable","value":"offre.id"},"hidden":{"type":"constant","value":false},"minLength":{"type":"constant","value":""},"maxLength":{"type":"constant","value":""},"readOnly":{"type":"constant","value":true},"min":{"type":"constant"},"max":{"type":"constant"},"step":{"type":"constant","value":1}},"reference":"352f520d-cd58-4d6d-a208-b01f24c31be0","id":"pbInput"}],[{"type":"component","dimension":{"md":6,"sm":12,"xs":12,"lg":6},"propertyValues":{"dateFormat":{"type":"constant","value":"MM/dd/yyyy"},"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant","value":"pbDatePicker"},"isDisplayed":{"type":"constant","value":true},"labelWidth":{"type":"constant","value":1},"label":{"type":"constant","value":"Date Debut"},"type":{"type":"constant"},"required":{"type":"constant","value":false},"forceUTC":{"type":"constant","value":false},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"labelPosition":{"type":"constant","value":"top"},"placeholder":{"type":"constant"},"alignment":{"type":"constant","value":"left"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.DatePickerWidget"},"dimension":{"type":"constant","value":12},"value":{"type":"variable","value":"offre.dateDebut"},"hidden":{"type":"constant","value":false},"readOnly":{"type":"constant","value":true},"showToday":{"type":"constant","value":false}},"reference":"9a4b36e2-8abe-4bdf-b47e-87233a3357df","id":"pbDatePicker"},{"type":"component","dimension":{"md":6,"sm":12,"xs":12,"lg":6},"propertyValues":{"dateFormat":{"type":"constant","value":"MM/dd/yyyy"},"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant","value":"pbDatePicker"},"isDisplayed":{"type":"constant","value":true},"labelWidth":{"type":"constant","value":1},"label":{"type":"constant","value":"Date Fin"},"type":{"type":"constant"},"required":{"type":"constant","value":false},"forceUTC":{"type":"constant","value":false},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"labelPosition":{"type":"constant","value":"top"},"placeholder":{"type":"constant"},"alignment":{"type":"constant","value":"left"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.DatePickerWidget"},"dimension":{"type":"constant","value":12},"value":{"type":"variable","value":"offre.dateFin"},"hidden":{"type":"constant","value":false},"readOnly":{"type":"constant","value":true},"showToday":{"type":"constant","value":false}},"reference":"b33df409-ffec-4900-bc80-2a25290f794d","id":"pbDatePicker"}],[{"type":"component","dimension":{"md":12,"sm":12,"xs":12,"lg":12},"propertyValues":{"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"level":{"type":"constant","value":"Level 4"},"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant","value":"pbTitle"},"isDisplayed":{"type":"constant","value":true},"label":{"type":"constant"},"text":{"type":"interpolation","value":"Produits"},"alignment":{"type":"constant","value":"left"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.TitleWidget"},"dimension":{"type":"constant","value":12}},"reference":"b09e46e6-f202-41cb-8b34-b3b2abf324da","id":"pbTitle"}],[{"type":"container","dimension":{"md":12,"sm":12,"xs":12,"lg":12},"propertyValues":{"repeatedCollection":{"type":"variable","value":"offre.produits"},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant"},"isDisplayed":{"type":"constant","value":true},"label":{"type":"constant"},"alignment":{"type":"constant","value":"left"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.WidgetContainer"},"dimension":{"type":"constant","value":12},"hidden":{"type":"constant","value":false}},"reference":"e5df4637-191e-4bae-8389-688c6bc897b3","rows":[[{"type":"component","dimension":{"md":6,"sm":12,"xs":12,"lg":4},"propertyValues":{"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant","value":"pbInput"},"isDisplayed":{"type":"constant","value":true},"labelWidth":{"type":"constant","value":1},"label":{"type":"constant","value":"Nom"},"type":{"type":"constant","value":"text"},"required":{"type":"constant","value":false},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"labelPosition":{"type":"constant","value":"top"},"placeholder":{"type":"constant"},"alignment":{"type":"constant","value":"left"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.InputWidget"},"dimension":{"type":"constant","value":12},"value":{"type":"variable","value":"$item.nom"},"hidden":{"type":"constant","value":false},"minLength":{"type":"constant","value":""},"maxLength":{"type":"constant","value":""},"readOnly":{"type":"constant","value":true},"min":{"type":"constant"},"max":{"type":"constant"},"step":{"type":"constant","value":1}},"reference":"3b1ecc89-9583-42da-a963-699ea8fe78d0","id":"pbInput"},{"type":"component","dimension":{"md":6,"sm":12,"xs":12,"lg":8},"propertyValues":{"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant","value":"pbInput"},"isDisplayed":{"type":"constant","value":true},"labelWidth":{"type":"constant","value":1},"label":{"type":"constant","value":"Prix Unitaire"},"type":{"type":"constant","value":"number"},"required":{"type":"constant","value":false},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"labelPosition":{"type":"constant","value":"top"},"placeholder":{"type":"constant"},"alignment":{"type":"constant","value":"left"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.InputWidget"},"dimension":{"type":"constant","value":12},"value":{"type":"variable","value":"$item.prixUnitaire"},"hidden":{"type":"constant","value":false},"minLength":{"type":"constant","value":""},"maxLength":{"type":"constant","value":""},"readOnly":{"type":"constant","value":true},"min":{"type":"constant"},"max":{"type":"constant"},"step":{"type":"constant","value":1}},"reference":"9a674c81-a9b8-4dc3-aaad-8836fd61c62b","id":"pbInput"}]]}]]}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":10,"lg":6},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"text":{"type":"interpolation","value":"Commande consolidee"},"level":{"type":"constant","value":"Level 2"},"alignment":{"type":"constant","value":"left"}},"reference":"6c23bd64-9bb5-4145-8d8e-613917adbb01","id":"pbTitle"},{"type":"component","dimension":{"xs":12,"sm":12,"md":2,"lg":6},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"disabled":{"type":"expression","value":"aucuneReservation"},"label":{"type":"interpolation","value":"Exporter"},"alignment":{"type":"constant","value":"center"},"buttonStyle":{"type":"constant","value":"primary"},"action":{"type":"constant","value":"GET"},"url":{"type":"interpolation","value":"../API/extension/exportCSV?offerId={{offre.persistenceId}}"},"dataToSend":{"type":"constant"},"dataFromSuccess":{"type":"variable","value":"csvSucces"},"dataFromError":{"type":"variable"},"targetUrlOnSuccess":{"type":"interpolation"},"collectionToModify":{"type":"variable"},"collectionPosition":{"type":"constant","value":"Last"},"valueToAdd":{"type":"constant"},"removeItem":{"type":"variable"}},"reference":"f6a32df6-4da5-40f1-abd2-890cb39f5e72","id":"pbButton"}],[{"type":"fragment","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"expression","value":"aucuneReservation"}},"reference":"0bc5ad78-183e-4725-b09f-d5af80f9d00a","id":"11a98aac-2095-42b6-ba7e-f8b92099b5e8","binding":{"panier":"panierConsolide","lectureSeule":"true"}}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":"text-warning"},"hidden":{"type":"expression","value":"!aucuneReservation"},"text":{"type":"interpolation","value":"Aucune reservation n'a encore ete faite."},"alignment":{"type":"constant","value":"center"}},"reference":"baead01a-c5fd-49bc-a0c6-0e296d811bcd","id":"pbText"}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"text":{"type":"interpolation","value":"Reservations"},"level":{"type":"constant","value":"Level 2"},"alignment":{"type":"constant","value":"left"}},"reference":"965533ad-1ad6-44c4-b351-5375e8b6c2f4","id":"pbTitle"}],[{"type":"container","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"expression","value":"aucuneReservation"},"repeatedCollection":{"type":"variable","value":"reservations"}},"reference":"af9ec7b0-5efd-49d0-ba1e-7d66f5a90ded","rows":[[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"text":{"type":"interpolation","value":"{{$item.dateDemande | date : 'yyyy/MM/dd'}} - #{{$item.persistenceId}}"},"level":{"type":"constant","value":"Level 3"},"alignment":{"type":"constant","value":"left"}},"reference":"e9e36215-5a9c-4c00-8c8f-bfbe73d980b8","id":"pbTitle"}],[{"type":"fragment","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false}},"reference":"4207b33f-f8a1-4326-bc69-4c0835d6d3ee","id":"11a98aac-2095-42b6-ba7e-f8b92099b5e8","binding":{"panier":"$item.panier","editable":"","lectureSeule":"true"}}]]}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":"text-warning"},"hidden":{"type":"expression","value":"!aucuneReservation"},"text":{"type":"interpolation","value":"Aucune reservation n'a encore ete faite."},"alignment":{"type":"constant","value":"center"}},"reference":"03b524e7-6927-40ef-8c67-5c22437df64c","id":"pbText"}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":true},"text":{"type":"interpolation","value":"{{reservations}}"},"alignment":{"type":"constant","value":"left"}},"reference":"245b4740-443a-4c2a-95b2-24b5f8b9fc7e","id":"pbText"}]],"assets":[{"id":"5bb96739-461f-4f7f-a6fa-4c958cf8c602","name":"base64-js.js","type":"js","order":2,"external":false},{"id":"0f11a5ad-f28e-43ae-b8d9-0b4cd07cf41c","name":"FileSaver.min.js","type":"js","order":1,"external":false},{"id":"908f22b0-ead1-441d-919e-3087b57c9ca7","name":"localization.json","type":"json","order":0,"external":false}],"inactiveAssets":[],"data":{"offre":{"type":"url","value":"../API/bdm/businessData/fr.bonitasoft.modele.OffreReservation/{{offreReservationId}}","exposed":false},"reservations":{"type":"url","value":"../API/bdm/businessData/fr.bonitasoft.modele.ReservationConciergerie?q=findByOffre&p=0&c=1000&f=offreId={{offre.persistenceId}}","exposed":false},"panierConsolide":{"type":"expression","value":"var panierConsolide = [];\n\nif($data.reservations) {\n    $data.reservations.forEach(function(reservation) {\n        reservation.panier.forEach(function(elementPanier) {\n            var panierConsolideElementPanier = panierConsolide.find(function(panierConsolideElementPanier) {\n                return elementPanier.produit.persistenceId === panierConsolideElementPanier.produit.persistenceId;\n            });\n            if(!panierConsolideElementPanier) {\n            // Copie l'element dans le panier consolide si pas encore fait pour cet element de panier\n                panierConsolide.push(JSON.parse(JSON.stringify(elementPanier)));\n            } else {\n                // Met a jour la quantite\n                panierConsolideElementPanier.quantite += elementPanier.quantite;\n            }\n        });\n    });\n}\n\nreturn panierConsolide;","exposed":false},"visuelURL":{"type":"expression","value":"if($data.offre) {\n    return \"/bonita/portal/documentDownload?fileName=\" + $data.offre.nomVisuel + \"&contentStorageId=\" + $data.offre.idVisuel;\n}","exposed":false},"aucuneReservation":{"type":"expression","value":"return !$data.reservations || $data.reservations.length === 0;","exposed":false},"csvSauvegarde":{"type":"expression","value":"if($data.csvSucces && $data.offre) {\n    // decode base64\n    var decoded = toByteArray($data.csvSucces.result);\n\n    // Save to file\n    saveAs(new Blob([decoded], { type: 'text/plain;charset=utf-8' }), 'Panier_consolide-' + $data.offre.type + '_' + $data.offre.id + '-' + (new Date()).getTime() + '.csv');\n\n    $data.csvSucces = undefined;\n}","exposed":false},"csvSucces":{"type":"constant","exposed":false},"offreReservationId":{"type":"urlparameter","value":"offreReservationId","exposed":false}}}