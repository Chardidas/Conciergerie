{"designerVersion":"1.3.25","favorite":false,"id":"7ecd56ad-ffec-4a64-99d3-4d685fbda200","name":"nouvelleDemandeReservation","type":"form","lastUpdate":1519344623257,"rows":[[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"text":{"type":"interpolation","value":"{{offreId}}"},"alignment":{"type":"constant","value":"left"}},"reference":"d25ed65f-d1bb-4c81-bee2-9dd56c9a71eb","id":"pbText"}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"text":{"type":"interpolation","value":"{{offre}}"},"alignment":{"type":"constant","value":"left"}},"reference":"cef86081-2b3b-4d59-a17c-912f70114e9d","id":"pbText"}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"text":{"type":"interpolation","value":"{{formOutput}}"},"alignment":{"type":"constant","value":"left"}},"reference":"86838c95-3356-492e-aa1c-96b2b35a41c3","id":"pbText"}],[{"type":"formContainer","dimension":{"xs":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false}},"reference":"d8985041-5c1b-4b53-8847-d9937e1f66c1","container":{"type":"container","dimension":{"xs":12},"propertyValues":{},"reference":"035771ff-a179-4524-bc26-950f42f83355","rows":[[{"type":"container","dimension":{"md":12,"sm":12,"xs":12,"lg":12},"propertyValues":{"repeatedCollection":{"type":"variable"},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant"},"isDisplayed":{"type":"constant","value":true},"label":{"type":"constant"},"alignment":{"type":"constant","value":"left"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.WidgetContainer"},"dimension":{"type":"constant","value":12},"hidden":{"type":"constant","value":false}},"reference":"ea96cfb7-61d7-43af-a054-68296fdcb5bd","rows":[[{"type":"container","dimension":{"md":12,"sm":12,"xs":12,"lg":12},"propertyValues":{"repeatedCollection":{"type":"variable","value":"formInput.reservationInput.panier"},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant"},"isDisplayed":{"type":"constant","value":true},"label":{"type":"constant"},"alignment":{"type":"constant","value":"left"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.WidgetContainer"},"dimension":{"type":"constant","value":12},"hidden":{"type":"constant","value":false}},"reference":"8e64d8e8-4c78-4bcd-9178-5110f4767308","rows":[[{"type":"component","dimension":{"md":5,"sm":12,"xs":12,"lg":3},"propertyValues":{"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant","value":"pbInput"},"isDisplayed":{"type":"constant","value":true},"labelWidth":{"type":"constant","value":1},"label":{"type":"constant","value":"Nom"},"type":{"type":"constant","value":"text"},"required":{"type":"constant","value":true},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"labelPosition":{"type":"constant","value":"top"},"placeholder":{"type":"constant"},"alignment":{"type":"constant","value":"left"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.InputWidget"},"dimension":{"type":"constant","value":12},"value":{"type":"variable","value":"$item.produit.nom"},"hidden":{"type":"constant","value":false},"minLength":{"type":"constant","value":""},"maxLength":{"type":"constant","value":""},"readOnly":{"type":"constant","value":true},"min":{"type":"constant"},"max":{"type":"constant"},"step":{"type":"constant","value":1}},"reference":"59e8a997-0e0e-41b6-bf5e-906d5fc46506","id":"pbInput"},{"type":"component","dimension":{"md":3,"sm":12,"xs":12,"lg":3},"propertyValues":{"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant","value":"pbInput"},"isDisplayed":{"type":"constant","value":true},"labelWidth":{"type":"constant","value":1},"label":{"type":"constant","value":"Quantite"},"type":{"type":"constant","value":"number"},"required":{"type":"constant","value":true},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"labelPosition":{"type":"constant","value":"top"},"placeholder":{"type":"constant"},"alignment":{"type":"constant","value":"left"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.InputWidget"},"dimension":{"type":"constant","value":12},"value":{"type":"variable","value":"$item.produit.quantite"},"hidden":{"type":"constant","value":false},"minLength":{"type":"constant","value":""},"maxLength":{"type":"constant","value":""},"readOnly":{"type":"constant","value":false},"min":{"type":"constant"},"max":{"type":"constant"},"step":{"type":"constant","value":1}},"reference":"c22aa59c-4504-45c1-b976-4a765bb11586","id":"pbInput"},{"type":"component","dimension":{"xs":12,"sm":12,"md":3,"lg":3},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"required":{"type":"constant","value":false},"minLength":{"type":"constant","value":""},"maxLength":{"type":"constant","value":""},"readOnly":{"type":"constant","value":true},"labelHidden":{"type":"constant","value":false},"label":{"type":"interpolation","value":"Prix Total"},"labelPosition":{"type":"constant","value":"top"},"labelWidth":{"type":"constant","value":4},"placeholder":{"type":"interpolation"},"value":{"type":"variable","value":"$item.produit.prixTotal"},"type":{"type":"constant","value":"text"},"min":{"type":"constant"},"max":{"type":"constant"},"step":{"type":"constant","value":1}},"reference":"e4208796-e0eb-4fb4-8bc6-8c8ecd4174f8","id":"pbInput"},{"type":"component","dimension":{"md":1,"sm":12,"xs":12,"lg":3},"propertyValues":{"removeItem":{"type":"variable","value":"$item"},"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant","value":"pbButton"},"buttonStyle":{"type":"constant","value":"danger"},"isDisplayed":{"type":"constant","value":true},"label":{"type":"constant","value":"X"},"dataToSend":{"type":"expression"},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"collectionPosition":{"type":"constant","value":"Item"},"targetUrlOnSuccess":{"type":"interpolation"},"action":{"type":"constant","value":"Remove from collection"},"collectionToModify":{"type":"variable","value":"$collection"},"valueToAdd":{"type":"expression"},"disabled":{"type":"constant","value":false},"alignment":{"type":"constant","value":"right"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.ButtonWidget"},"dimension":{"type":"constant","value":12},"hidden":{"type":"constant","value":false},"url":{"type":"interpolation"},"dataFromSuccess":{"type":"variable"},"dataFromError":{"type":"variable"}},"reference":"366e840c-6f5c-48fe-a7cd-926bd72bcb0f","id":"pbButton"}]]}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":11,"lg":6},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"disabled":{"type":"constant","value":false},"required":{"type":"constant","value":false},"labelHidden":{"type":"constant","value":false},"label":{"type":"interpolation","value":"Nouvel element"},"labelPosition":{"type":"constant","value":"top"},"labelWidth":{"type":"constant","value":4},"placeholder":{"type":"interpolation","value":""},"availableValues":{"type":"expression","value":"elementsDisponibles"},"displayedKey":{"type":"constant","value":"nom + \" - \" + prixUnitaire"},"returnedKey":{"type":"constant"},"value":{"type":"variable","value":"produitSelectione"}},"reference":"ace2dcae-4bd0-4ce8-81ec-0abf7f2fd1f2","id":"pbSelect"},{"type":"component","dimension":{"md":1,"sm":12,"xs":12,"lg":6},"propertyValues":{"removeItem":{"type":"variable"},"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant","value":"pbButton"},"buttonStyle":{"type":"constant","value":"success"},"isDisplayed":{"type":"constant","value":true},"label":{"type":"constant","value":"+"},"dataToSend":{"type":"expression"},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"collectionPosition":{"type":"constant"},"targetUrlOnSuccess":{"type":"interpolation"},"action":{"type":"constant","value":"Add to collection"},"collectionToModify":{"type":"variable","value":"formInput.reservationInput.panier"},"valueToAdd":{"type":"expression","value":"nouveauProduit"},"disabled":{"type":"expression","value":"!produitSelectione"},"alignment":{"type":"constant","value":"right"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.ButtonWidget"},"dimension":{"type":"constant","value":12},"hidden":{"type":"constant","value":false},"url":{"type":"interpolation"},"dataFromSuccess":{"type":"variable"},"dataFromError":{"type":"variable"}},"reference":"e10c14e0-a8ae-4d9f-ab9d-5f3d7d1965e3","id":"pbButton"}]]}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"required":{"type":"constant","value":false},"minLength":{"type":"constant","value":""},"maxLength":{"type":"constant","value":""},"readOnly":{"type":"constant","value":true},"labelHidden":{"type":"constant","value":false},"label":{"type":"interpolation","value":"Grand Total"},"labelPosition":{"type":"constant","value":"top"},"labelWidth":{"type":"constant","value":4},"placeholder":{"type":"interpolation"},"value":{"type":"variable","value":"grandTotal"},"type":{"type":"constant","value":"text"},"min":{"type":"constant"},"max":{"type":"constant"},"step":{"type":"constant","value":1}},"reference":"25032672-75f0-4360-bf49-bfb2d1d5db80","id":"pbInput"}],[{"type":"component","dimension":{"md":12,"sm":12,"xs":12,"lg":12},"propertyValues":{"removeItem":{"type":"variable"},"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant","value":"pbButton"},"buttonStyle":{"type":"constant","value":"primary"},"isDisplayed":{"type":"constant","value":true},"label":{"type":"constant","value":"Submit"},"dataToSend":{"type":"expression","value":"formOutput"},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"collectionPosition":{"type":"constant"},"targetUrlOnSuccess":{"type":"interpolation","value":"/bonita"},"action":{"type":"constant","value":"Start process"},"collectionToModify":{"type":"variable"},"valueToAdd":{"type":"expression"},"disabled":{"type":"expression","value":"$form.$invalid || grandTotal == 0"},"alignment":{"type":"constant","value":"center"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.ButtonWidget"},"dimension":{"type":"constant","value":12},"hidden":{"type":"constant","value":false},"url":{"type":"interpolation"},"dataFromSuccess":{"type":"variable"},"dataFromError":{"type":"variable"}},"reference":"571ca1df-1ca8-4f89-a027-e63c3f2da732","id":"pbButton"}]]}}]],"assets":[{"id":"83de95ef-a77e-429a-8898-6983c1dc9967","name":"localization.json","type":"json","order":0,"external":false}],"inactiveAssets":[],"data":{"formInput":{"type":"json","value":"{\r\n  \"reservationInput\" : {\r\n    \"panier\" : [ ],\r\n    \"offre\": {}\r\n  }\r\n}","exposed":false},"formOutput":{"type":"expression","value":"var contrat = {\n\t'reservationInput': $data.formInput.reservationInput\n};\n\nif($data.session && $data.session.user_id) {\n    contrat.reservationInput.idDemandeur = $data.session.user_id;\n}\n\ncontrat.reservationInput.dateDemande = new Date();\n\nif($data.offreId) {\n    contrat.reservationInput.offre.persistenceId = $data.offreId;\n}\n\nreturn contrat;","exposed":false},"session":{"type":"url","value":"../API/system/session/1","exposed":false},"offreId":{"type":"constant","value":"offreId","exposed":false},"offre":{"type":"url","value":"../API/bdm/businessData/fr.bonitasoft.modele.OffreReservation/{{offreId}}","exposed":false},"elementsDisponibles":{"type":"expression","value":"if($data.offre && $data.offre.produits && $data.formOutput && $data.formOutput.reservationInput && $data.formOutput.reservationInput.panier) {\n    return $data.offre.produits.filter(function(item) {\n        return !$data.formOutput.reservationInput.panier.map(function(element) { return element.produit.persistenceId; }).includes(item.persistenceId);\n    });\n}\n\nreturn [];","exposed":false},"produitSelectione":{"type":"constant","exposed":false},"nouveauProduit":{"type":"expression","value":"return { \n    \"produit\" : {\n        \"persistenceId\" : $data.produitSelectione.persistenceId,\n        \"nom\" : $data.produitSelectione.nom,\n        \"prixUnitaire\" : $data.produitSelectione.prixUnitaire,\n        \"quantite\" : 1,\n        \"prixTotal\" : $data.produitSelectione.prixUnitaire\n    }\n};","exposed":false},"miseAJourPrixTotaux":{"type":"expression","value":"if($data.formOutput && $data.formOutput.reservationInput && $data.formOutput.reservationInput.panier) {\n    $data.formOutput.reservationInput.panier.forEach(function(item) {\n        item.produit.prixTotal = item.produit.prixUnitaire * item.produit.quantite;\n    });\n}","exposed":false},"grandTotal":{"type":"expression","value":"var grandTotal = 0;\n\nif($data.formOutput && $data.formOutput.reservationInput && $data.formOutput.reservationInput.panier) {\n    $data.formOutput.reservationInput.panier.forEach(function(item) {\n        grandTotal += item.produit.prixTotal;\n    });\n}\n\nreturn grandTotal;","exposed":false}}}