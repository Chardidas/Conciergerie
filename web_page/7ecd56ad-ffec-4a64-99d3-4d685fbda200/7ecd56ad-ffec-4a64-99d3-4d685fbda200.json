{"designerVersion":"1.3.25","favorite":false,"id":"7ecd56ad-ffec-4a64-99d3-4d685fbda200","name":"nouvelleDemandeReservation","type":"form","lastUpdate":1519674589353,"rows":[[{"type":"container","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":true},"repeatedCollection":{"type":"variable"}},"reference":"6b34543e-f1ed-41da-9e4f-b68e92a41598","rows":[[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"text":{"type":"interpolation","value":"{{offreId}}"},"alignment":{"type":"constant","value":"left"}},"reference":"2b971080-04cb-41dd-b838-aa6414c95ef2","id":"pbText"}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"text":{"type":"interpolation","value":"{{offre}}"},"alignment":{"type":"constant","value":"left"}},"reference":"549b34f2-2448-4ebb-bb07-97ea7966c930","id":"pbText"}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"text":{"type":"interpolation","value":"{{formOutput}}"},"alignment":{"type":"constant","value":"left"}},"reference":"3e218048-f0fc-40a0-b72e-94d000e327f5","id":"pbText"}]]}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"text":{"type":"interpolation","value":"Nouvelle reservation - {{offre.type}} - {{offre.id}}"},"level":{"type":"constant","value":"Level 1"},"alignment":{"type":"constant","value":"left"}},"reference":"f62f40e7-45dc-4a79-9cf7-bd6e6559045d","id":"pbTitle"}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"srcType":{"type":"constant","value":"URL"},"url":{"type":"expression","value":"visuelURL"},"assetName":{"type":"constant"},"alt":{"type":"interpolation"}},"reference":"69f7a805-6a0a-44a9-bbba-deb7c6c58d10","id":"pbImage"}],[{"type":"formContainer","dimension":{"xs":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false}},"reference":"d8985041-5c1b-4b53-8847-d9937e1f66c1","container":{"type":"container","dimension":{"xs":12},"propertyValues":{},"reference":"035771ff-a179-4524-bc26-950f42f83355","rows":[[{"type":"fragment","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false}},"reference":"1a48dafb-a24a-4874-a30c-f32b634a6ed2","id":"11a98aac-2095-42b6-ba7e-f8b92099b5e8","binding":{"formOutput":"$data.formOutput.reservationInput.panier","panier":"formInput.reservationInput.panier"}}],[{"type":"component","dimension":{"md":12,"sm":12,"xs":12,"lg":12},"propertyValues":{"removeItem":{"type":"variable"},"cssClasses":{"type":"constant","value":""},"widgetId":{"type":"constant","value":"pbButton"},"buttonStyle":{"type":"constant","value":"primary"},"isDisplayed":{"type":"constant","value":true},"label":{"type":"constant","value":"Reserver"},"dataToSend":{"type":"expression","value":"formOutput"},"labelHidden":{"type":"constant","value":false},"readonly":{"type":"constant","value":false},"collectionPosition":{"type":"constant"},"targetUrlOnSuccess":{"type":"interpolation","value":"/bonita"},"action":{"type":"constant","value":"Start process"},"collectionToModify":{"type":"variable"},"valueToAdd":{"type":"expression"},"disabled":{"type":"expression","value":"$form.$invalid || formInput.reservationInput.panier && formInput.reservationInput.panier.length === 0"},"alignment":{"type":"constant","value":"center"},"class":{"type":"constant","value":"org.bonitasoft.web.designer.experimental.parametrizedWidget.ButtonWidget"},"dimension":{"type":"constant","value":12},"hidden":{"type":"constant","value":false},"url":{"type":"interpolation"},"dataFromSuccess":{"type":"variable"},"dataFromError":{"type":"variable"}},"reference":"571ca1df-1ca8-4f89-a027-e63c3f2da732","id":"pbButton"}]]}}]],"assets":[{"id":"83de95ef-a77e-429a-8898-6983c1dc9967","name":"localization.json","type":"json","order":0,"external":false}],"inactiveAssets":[],"data":{"formInput":{"type":"expression","value":"var formInput = {\r\n  \"reservationInput\" : {\r\n    \"panier\" : [ ],\r\n    \"offre\": {}\r\n  }\r\n};\r\n\r\nif($data.offre && $data.offre.produits) {\r\n    $data.offre.produits.map(function(item) {\r\n        formInput.reservationInput.panier.push({\r\n            \"produit\": item,\r\n            \"quantite\" : 0,\r\n            \"prixTotal\" : 0\r\n        });\r\n    });\r\n}\r\n\r\nreturn formInput;","exposed":false},"formOutput":{"type":"expression","value":"var contrat = {\n\t'reservationInput': $data.formInput.reservationInput\n};\n\nif($data.session && $data.session.user_id) {\n    contrat.reservationInput.idDemandeur = $data.session.user_id;\n}\n\ncontrat.reservationInput.dateDemande = new Date();\n\nif($data.offreId) {\n    contrat.reservationInput.offre.persistenceId = $data.offreId;\n}\n\nreturn contrat;","exposed":false},"session":{"type":"url","value":"../API/system/session/1","exposed":false},"offreId":{"type":"urlparameter","value":"offreId","exposed":false},"offre":{"type":"url","value":"../API/bdm/businessData/fr.bonitasoft.modele.OffreReservation/{{offreId}}","exposed":false},"visuelURL":{"type":"expression","value":"if($data.offre) {\n    return \"/bonita/portal/documentDownload?fileName=\" + $data.offre.nomVisuel + \"&contentStorageId=\" + $data.offre.idVisuel;\n}","exposed":false}}}