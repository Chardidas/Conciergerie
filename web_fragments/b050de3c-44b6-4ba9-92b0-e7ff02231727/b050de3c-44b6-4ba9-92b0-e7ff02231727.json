{"designerVersion":"1.3.25","favorite":false,"id":"b050de3c-44b6-4ba9-92b0-e7ff02231727","name":"FamillesFragment","type":"fragment","lastUpdate":1520471557150,"rows":[[{"type":"component","dimension":{"xs":12,"sm":12,"md":6,"lg":6},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"disabled":{"type":"expression","value":"readOnly"},"required":{"type":"constant","value":false},"labelHidden":{"type":"constant","value":false},"label":{"type":"interpolation","value":"Famille"},"labelPosition":{"type":"constant","value":"top"},"labelWidth":{"type":"constant","value":4},"placeholder":{"type":"interpolation","value":"Select an option"},"availableValues":{"type":"expression","value":"famillesDemande"},"displayedKey":{"type":"constant"},"returnedKey":{"type":"constant"},"value":{"type":"variable","value":"demande.familleDemande"}},"reference":"f1b0f9bc-b9f4-4dff-b3b6-b64f41c31300","id":"pbSelect"},{"type":"component","dimension":{"xs":12,"sm":12,"md":6,"lg":6},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"expression","value":"sousFamilleCachee"},"disabled":{"type":"expression","value":"readOnly"},"required":{"type":"expression","value":"mandatory"},"labelHidden":{"type":"constant","value":false},"label":{"type":"interpolation","value":"Sous-Famille"},"labelPosition":{"type":"constant","value":"top"},"labelWidth":{"type":"constant","value":4},"placeholder":{"type":"interpolation","value":"Select an option"},"availableValues":{"type":"expression","value":"quelSousFamille"},"displayedKey":{"type":"constant"},"returnedKey":{"type":"constant"},"value":{"type":"variable","value":"demande.sousFamilleDemande"}},"reference":"6d785610-ddd4-4a7b-91cf-199e0d608eb8","id":"pbSelect"}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":true},"text":{"type":"interpolation","value":"<pre>{{demande | json}}"},"alignment":{"type":"constant","value":"left"}},"reference":"70bea06d-a817-42c0-8ce4-39113b97ac2c","id":"pbText"}]],"assets":[],"inactiveAssets":[],"data":{"sousFamilleAutomobile":{"type":"json","value":"[\"Lavage\", \"Révision/Entretien/Réparation\", \"Pneus\", \"Contrôle technique\",\"Autres\"]","exposed":false},"sousFamilleDemarchesAdmin":{"type":"json","value":"[\"Services postaux\", \"Autres\"]","exposed":false},"quelSousFamille":{"type":"expression","value":"var sousFamilleToReturn = {};\nif ($data.demande){\n    if (typeof $data.demande.familleDemande === 'undefined'){\n        return;\n    }\n     if (typeof $data.demande.sousFamilleDemande !== 'undefined'){\n         if ($data.oldSousFamille === 'notLoaded'){\n             //console.log(\"initializing\");\n         } else {\n             console.log(\"#### old sous famille : \" + $data.oldSousFamille);\n             console.log(\"#### sous famille : \" + $data.demande.sousFamilleDemande);\n             if ($data.oldSousFamille !== $data.demande.sousFamilleDemande && $data.readOnly === false){\n                $data.demande.detailDemande = {};\n            } else {\n                // maybe famille changed, so need to compare\n                if ($data.oldFamille !== $data.demande.familleDemande && $data.readOnly === false){\n                    $data.demande.detailDemande = {};\n                }\n            }\n         }\n        $data.oldSousFamille = $data.demande.sousFamilleDemande;\n        $data.oldFamille = $data.demande.familleDemande;\n     }\n    //$data.oldFamille = $data.demande.familleDemande;\n    if ($data.demande.familleDemande == \"Automobile\"){\n        $data.sousFamilleCachee = false;\n        sousFamilleToReturn = $data.sousFamilleAutomobile;\n    }\n    if ($data.demande.familleDemande == \"Démarches administratives\"){\n        $data.sousFamilleCachee = false;\n        sousFamilleToReturn = $data.sousFamilleDemarchesAdmin;\n    }\n    if ($data.readOnly === false && $data.demande.familleDemande != \"Automobile\" && $data.demande.familleDemande != \"Démarches administratives\"){\n        $data.demande.sousFamilleDemande = \"\";\n        $data.sousFamilleCachee = true;\n    }\n}\nreturn sousFamilleToReturn;","exposed":false},"demande":{"type":"constant","exposed":true},"sousFamilleCachee":{"type":"constant","value":"true","exposed":false},"readOnly":{"type":"constant","exposed":true},"mandatory":{"type":"constant","exposed":true},"rolesOfConnectedUser":{"type":"url","value":"../API/identity/membership?p=0&c=10&f=user_id={{session.user_id}}&d=role_id","exposed":false},"isConnectedUserAConcierge":{"type":"expression","value":"if ($data.rolesOfConnectedUser && $data.rolesOfConnectedUser.length > 0){\n    for (var membershipIndex in $data.rolesOfConnectedUser) {\n        var membership = $data.rolesOfConnectedUser[membershipIndex];\n        if (membership.role_id.name == 'Concierge'){\n            return true;\n        }\n    }\n}\nreturn false;","exposed":false},"famillesDemande":{"type":"expression","value":"var familleUser = [\"Automobile\", \"Recherche d'artisan\", \"Services à domicile\", \"Courses/Autres\"];\nvar familleConcierge = [\"Automobile\", \"Recherche d'artisan\", \"Services à domicile\", \"Démarches administratives\", \"Courses/Autres\", \"Services rendus\"];\nif ($data.rolesOfConnectedUser){\n    if ($data.isConnectedUserAConcierge){\n        return familleConcierge;\n    } else {\n        return familleUser;\n    }\n}","exposed":false},"session":{"type":"url","value":"../API/system/session/1","exposed":false},"allValues":{"type":"constant","exposed":true},"shouldAddAllValues":{"type":"expression","value":"if ($data.allValues && $data.famillesDemande){\n    if (!$data.famillesDemande.includes(\"Tous\")){\n        $data.famillesDemande.push(\"Tous\");\n    }\n    if (!$data.sousFamilleAutomobile.includes(\"Tous\")){\n        $data.sousFamilleAutomobile.push(\"Tous\");\n    }\n    if (!$data.sousFamilleDemarchesAdmin.includes(\"Tous\")){\n        $data.sousFamilleDemarchesAdmin.push(\"Tous\");\n    }\n}\nreturn \"hello\";","exposed":false},"oldFamille":{"type":"constant","exposed":false},"oldSousFamille":{"type":"constant","value":"notLoaded","exposed":false}}}