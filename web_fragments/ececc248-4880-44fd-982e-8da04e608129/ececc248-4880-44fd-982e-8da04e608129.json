{"designerVersion":"1.3.25","favorite":false,"id":"ececc248-4880-44fd-982e-8da04e608129","name":"bandeauActions","type":"fragment","lastUpdate":1520468297808,"rows":[[{"type":"container","dimension":{"xs":12,"sm":12,"md":7,"lg":7},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"repeatedCollection":{"type":"variable","value":"tasks"}},"reference":"94dfcf37-286b-4128-bee0-13d5cec4f337","rows":[[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":""},"hidden":{"type":"constant","value":false},"text":{"type":"interpolation","value":"{{$item.name}}"},"targetUrl":{"type":"expression","value":"\"/bonita/portal/form/taskInstance/\" + $item.id"},"target":{"type":"constant","value":"_parent"},"alignment":{"type":"constant","value":"center"},"buttonStyle":{"type":"constant","value":"primary"}},"reference":"3e634b26-b732-4ae1-be0c-e9c0e719e260","id":"pbLink"}]]},{"type":"component","dimension":{"xs":12,"sm":12,"md":1,"lg":1},"propertyValues":{"cssClasses":{"type":"constant","value":"pull-right"},"hidden":{"type":"constant","value":false},"disabled":{"type":"constant","value":false},"label":{"type":"interpolation","value":"<i class=\"glyphicon glyphicon-remove\"></i>"},"alignment":{"type":"constant","value":"right"},"buttonStyle":{"type":"constant","value":"primary"},"objectToNullify":{"type":"variable","value":"demandeSelectionnee"}},"reference":"efef2fcd-9d7d-445b-9756-0de6330be198","id":"customButtonCloseModal"},{"type":"component","dimension":{"xs":12,"sm":12,"md":1,"lg":1},"propertyValues":{"cssClasses":{"type":"constant","value":"pull-right"},"hidden":{"type":"constant","value":false},"disabled":{"type":"constant","value":false},"label":{"type":"interpolation","value":"<i class=\"glyphicon glyphicon-trash\"></i>"},"alignment":{"type":"constant","value":"right"},"buttonStyle":{"type":"constant","value":"primary"},"action":{"type":"constant","value":"POST"},"url":{"type":"interpolation","value":"../API/bpm/process/{{latestVersionOfCancelDemandeProcess[0].id}}/instantiation"},"dataToSend":{"type":"expression","value":"cancelDemandeContract"},"dataFromSuccess":{"type":"variable","value":"annulationCase"},"dataFromError":{"type":"variable","value":"annulationCase"},"targetUrlOnSuccess":{"type":"interpolation","value":""},"collectionToModify":{"type":"variable"},"collectionPosition":{"type":"constant","value":"Last"},"valueToAdd":{"type":"constant"},"removeItem":{"type":"variable"}},"reference":"951a9b3b-31cf-4e65-aa9a-171d7c6aa1c0","id":"pbButton"},{"type":"component","dimension":{"xs":12,"sm":12,"md":3,"lg":3},"propertyValues":{"cssClasses":{"type":"constant","value":"pull-right"},"hidden":{"type":"constant","value":false},"disabled":{"type":"constant","value":false},"label":{"type":"interpolation","value":"<i class=\"glyphicon glyphicon-print\"></i>"},"alignment":{"type":"constant","value":"right"},"buttonStyle":{"type":"constant","value":"primary"},"action":{"type":"constant","value":"GET"},"url":{"type":"interpolation","value":"../API/extension/impression?userId={{userId}}&caseId={{demandeSelectionnee.caseId}}"},"dataToSend":{"type":"constant"},"dataFromSuccess":{"type":"variable"},"dataFromError":{"type":"variable","value":"error"},"targetUrlOnSuccess":{"type":"interpolation"},"collectionToModify":{"type":"variable"},"collectionPosition":{"type":"constant","value":"Last"},"valueToAdd":{"type":"constant"},"removeItem":{"type":"variable"},"print":{"type":"constant","value":true}},"reference":"22c4bc62-3748-4d52-a41e-9dfe4df72a65","id":"customButtonWithPrint"}],[{"type":"component","dimension":{"xs":12,"sm":12,"md":12,"lg":12},"propertyValues":{"cssClasses":{"type":"constant","value":"bg-warning"},"hidden":{"type":"expression","value":"annulationMessage.length == 0 || annulationMessage == undefined"},"text":{"type":"interpolation","value":"{{annulationMessage}}"},"alignment":{"type":"constant","value":"left"}},"reference":"02a84c61-6e4e-49f3-8ccd-32af689cbfc5","id":"pbText"}]],"assets":[],"inactiveAssets":[],"data":{"demandeSelectionnee":{"type":"constant","exposed":true},"latestVersionOfCancelDemandeProcess":{"type":"url","value":"../API/bpm/process?p=0&c=1&f=name=Annuler%20une%20demande%20de%20service&f=activationState=ENABLED&o=version%20DESC","exposed":false},"cancelDemandeContract":{"type":"expression","value":"return { 'demandeId' : $data.demandeSelectionnee.persistenceId };","exposed":false},"annulationMessage":{"type":"expression","value":"if ($data.annulationCase) {\n    if ($data.annulationCase.exception){\n        return \"Un problème est survenu. Veuillez contacter votre administrateur.\";\n    }\n    if($data.annulationCase.caseId){\n        console.log('statut : ' + $data.demandeSelectionnee.statutDemande);\n        if ($data.demandeSelectionnee.statutDemande == 'Brouillon'){\n            window.location = '/bonita/apps/conciergerie/confirmation?message=DELETEBROUILLON';\n        } else {\n            return \"Votre demande d'annulation a bien été transmise à la conciergerie.\";\n        }\n    }\n}","exposed":false},"tasks":{"type":"url","value":"../API/bpm/humanTask?p=0&c=10&f=caseId={{demandeSelectionnee.caseId}}&f=assigned_id={{userId}}&f=state=ready","exposed":false},"userId":{"type":"constant","exposed":true},"annulationCase":{"type":"constant","exposed":false}}}